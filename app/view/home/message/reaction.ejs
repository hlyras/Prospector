<script>
  function messageReaction(message) {
    let last_message_datetime = document.getElementById(`last-message-datetime-${message.jid}`);
    last_message_datetime.innerHTML = "";
    last_message_datetime.innerHTML = lib.splitTextBy(lib.timestampToFulldate(message.datetime), " ")[1];

    let last_message = document.getElementById(`last-message-${message.jid}`);
    last_message.innerHTML = "";

    last_message.innerHTML = message.content;

    let message_reaction_box = document.getElementById(`message-${message.target_id}-reaction-box`);
    if (!message_reaction_box) { return; }

    if (message.content) {
      let message_reaction_div = reactionDiv(message);
      message_reaction_box.append(message_reaction_div);

      if (message.origin_id) {
        document.getElementById(`message-${message.origin_id}-reaction`).remove();
      }
    } else {
      document.getElementById(`message-${message.origin_id}-reaction`).remove();
    }
  };

  function reactionDiv(message) {
    let message_reaction_div = lib.element.create("div", {
      id: `message-${message.wa_id}-reaction`,
      class: "ground em08 padding-3 margin-1 radius-50 shadow-lg-st pointer noselect",
    }, message.content);

    message_reaction_div.addEventListener("click", () => {
      console.log(message);
    });

    return message_reaction_div;
  };
</script>